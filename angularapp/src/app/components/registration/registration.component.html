<div class="register-container">
    <h1>Registration</h1>
    <form #registrationForm="ngForm" (ngSubmit)="register()">
        <!-- Username Field -->
        <label for="username">Username<span class="astrick">*</span></label>
        <input
            type="text"
            id="username"
            name="username"
            required
            [(ngModel)]="user.Username"
            #username="ngModel"
        />
        <div *ngIf="username.invalid && (username.dirty || username.touched)" class="error">
            Username is required.
        </div>

        <!-- Email Field -->
        <label for="email">Email<span class="astrick">*</span></label>
        <input
            type="email"
            id="email"
            name="email"
            required
            [(ngModel)]="user.Email"
            #email="ngModel"
        />
        <div *ngIf="email.invalid && (email.dirty || email.touched)" class="error">
            A valid email is required.
        </div>

        <!-- Mobile Number Field -->
        <label for="mobileNumber">Mobile Number<span class="astrick">*</span></label>
        <input
            type="text"
            id="mobileNumber"
            name="mobileNumber"
            required
            [(ngModel)]="user.MobileNumber"
            #mobileNumber="ngModel"
            pattern="^[0-9]{10}$"
        />
        <div *ngIf="mobileNumber.invalid && (mobileNumber.dirty || mobileNumber.touched)" class="error">
            Mobile number must be 10 digits.
        </div>

        <!-- Password Field -->
        <label for="password">Password<span class="astrick">*</span></label>
        <input
            type="password"
            id="password"
            name="password"
            required
            [(ngModel)]="user.Password"
            #password="ngModel"
            pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[\W_]).{8,}"
        />
        <div class="hint">
            Password must be at least 8 characters long and include uppercase, lowercase, numbers, and special characters.
        </div>
        <div *ngIf="password.invalid && (password.dirty || password.touched)" class="error">
            Password must meet the complexity requirements.
        </div>
        <div>
            <label for="confirmPassword" class="label">Confirm Password<span class="required-asterisk">*</span></label>
            <input type="password" id="confirmPassword" name="confirmPassword" required [(ngModel)]="confirmPassword"
                [ngModelOptions]="{standalone: true}" #confirmpassword="ngModel">
            <div *ngIf="confirmpassword.invalid && (confirmpassword.dirty || confirmpassword.touched)"
                class="error-message">Confirm Password is required</div>
            <div *ngIf="confirmpassword.value !== password && confirmpassword.dirty" class="error-message">
                Passwords do not match</div>
        </div>
        
        <!-- Role Field -->
        <label for="userRole">Role<span class="astrick">*</span></label>
        <select
            id="userRole"
            name="userRole"
            [(ngModel)]="user.UserRole"
            #userRole="ngModel"
            required
            (change)="onRoleChange()"
        >
            <option value="">Select Role</option>
            <option value="Admin">Admin</option>
            <option value="User">User</option>
        </select>
        <div *ngIf="userRole.invalid && (userRole.dirty || userRole.touched)" class="error">
            Please select a role.
        </div>

        <!-- Secret Key Field (only for Admin role) -->
        <div *ngIf="showSecretKeyField">
            <label for="secretKey">Secret Key<span class="astrick">*</span></label>
            <input
                type="password"
                id="secretKey"
                name="secretKey"
                [(ngModel)]="user.SecretKey"
                #secretKey="ngModel"
                required
            />
            <div *ngIf="secretKey.invalid && (secretKey.dirty || secretKey.touched)" class="error">
                Secret Key is required for the Admin role.
            </div>
        </div>

        <!-- Submit Button -->
        <button type="submit" [disabled]="registrationForm.invalid">Register</button>

        <!-- Error Message -->
        <div *ngIf="errorMessage" class="error">
            {{ errorMessage }}
        </div>
    </form>
</div>
